!function(C){"use strict";var v="ht",D=C[v],S=function(){return document},l=function(){return S().body},Q=function(A,J,Z){A.style.setProperty(J,Z,null)},U=function(X){return S().createElement(X)},j=function(){return U("div")},I=function(){var M=U("canvas");return M},w=function(A,h){Q(A,"-webkit-transform",h),Q(A,"-ms-transform",h),Q(A,"transform",h)},A=function(e,z){Q(e,"-webkit-transform-origin",z),Q(e,"-ms-transform-origin",z),Q(e,"transform-origin",z)},t=function(b,g){b.appendChild(g)},E=function(u,W){u.removeChild(W)},g=C.parseInt,P=D.Default,u=P.getInternal(),c=Math.PI,J="white-space",R="visibility",M="left",y="top",q="width",L="height",O="position",o="display",e="z-index",m="px",K="0 0",r="absolute",s="visible",G="hidden",i="none",z="block",Z="nowrap",Y="rgba(0, 0, 0, 0.005)";P.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var h=D.graph.GraphView.prototype,B=h._42;h.adjustHtmlNodeIndex=!0,h._42=function(v,b){if(B.call(this,v,b),this.adjustHtmlNodeIndex)for(var w=this.getDataModel()._datas._as,L=w.length,T=1,V=0;L>V;V++){var k=w[V];if(k instanceof x){var m=this.getDataUI(k);Q(m.$2f,e,T+""),Q(m.$3f,e,T+1+""),T+=2}}};var W=D.HtmlNodeUI=function(z,h){var P=this;W.superClass.constructor.call(P,z,h);var x=P.$2f=j(),n=P.$3f=I();Q(x,O,r),Q(x,R,G),Q(x,J,Z),n.draggable=!1,Q(n,O,r),Q(n,o,i),A(n,K),x.addEventListener("change",function(U){var k=U.target,N=k.bind||k.getAttribute("bind"),w=k.type&&"checkbox"===k.type?k.checked:k.value,r=h.getContext();N&&r&&(r[N]=w,P.$4f=JSON.stringify(r))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(k){x.addEventListener(k,this.$9f.bind(this))},P)};P.def(W,u.ui().NodeUI,{_visible:!0,$11f:function(){var h=this,x=h.$3f,q=h._data,b=q.getDraggerImageWidth(),r=q.getDraggerImageHeight(),X=q.getDraggerImage(),o=u.initContext(x);o.beginPath(),u.setCanvas(x,b,r),u.translateAndScale(o,0,0,1),o.clearRect(0,0,b,r),P.drawImage(o,P.getImage(X),0,0,b,r),o.restore()},_80o:function($){W.superClass._80o.call(this,$);var P=this,F=P._data,C=F._padding,X=2*C,N=P.$2f,h=P.$3f,V=P.gv,p=V.getZoom(),K=V.getTranslateX(),Z=V.getTranslateY(),S=V.getView(),k=P._83o,D=F._width,H=F._height,J=k.position,T=k.rotation,d=(D-X)/F.$5f*p,f=(H-X)/F.$6f*p,U=P._html,B=F._html,n=F.getHtmlType();if("html"===n){var v=F.getContext()||{},b=P.$4f,u=F.$10f,E=JSON.stringify(v);U&&b&&U===B&&b===E||(P.$4f=E,P._html=B,N.innerHTML=u?u(v):B)}else if(null!=n){var x=F.getHtml();"ht"===n&&(x=x.getView()),U&&U===x||(P._html=x,N.innerHTML="",t(N,x))}if(!N.parentNode){var l=V.$1f;if(!l){var a=j();Q(a,O,r),Q(a,e,"0"),l=V.$1f=a;var A=V._canvas.nextSibling;A?S.insertBefore(a,A):t(S,a)}t(l,N),t(l,h)}if(F._scalable){var I=F.$5f,_=F.$6f;w(N,"rotate("+180*(T/c)+"deg) scale("+d+","+f+")"),Q(N,M,(J.x-I/p/2)*p+K+m),Q(N,y,(J.y-_/p/2)*p+Z+m)}else{var Ze=g(N.style.width),yr=g(N.style.height),ch=g((D-X)*p),qg=g((H-X)*p),tp="100%",wg=N.children[0];Q(wg,q,tp),Q(wg,L,tp),(Ze!==ch||yr!==qg)&&(Q(N,q,ch+m),Q(N,L,qg+m),"ht"===n&&B.invalidate()),w(N,"rotate("+180*(T/c)+"deg)"),Q(N,M,(J.x-ch/p/2)*p+K+m),Q(N,y,(J.y-qg/p/2)*p+Z+m)}var Re=P.dragRect;V.isMovable(F)&&V.isSelected(F)&&Re?($.save(),$.fillStyle=Y,$.fillRect(Re.x,Re.y,Re.width,Re.height),$.restore(),Q(h,M,Re.x*p+K+m),Q(h,y,Re.y*p+Z+m),w(h,"scale("+p+","+p+")"),Q(h,o,z),P.$11f()):Q(h,o,i),Q(N,R,this._visible?s:G)},dispose:function(){var T=this.gv.$1f;T.removeChild(this.$2f),T.removeChild(this.$3f)},_84o:function(l){this._visible=l,Q(this.$2f,R,l?s:G),Q(this.$3f,o,l?z:i)},_3O:function(){var q=this,x=q._data;W.superClass._3O.call(q);var X=x.getRect();q.dragRect={x:X.x+X.width+x._padding,y:X.y+10,width:x.getDraggerImageWidth(),height:x.getDraggerImageHeight()},q._68o(q.dragRect)},rectIntersects:function(h){var p=this._79o();return D.Default.intersection(p,h)?!0:void 0},$9f:function(K){var e=this.gv,R=this._data;e.sm().contains(R)&&K.stopPropagation()}});var x=D.HtmlNode=function(){x.superClass.constructor.call(this)};D.Default.def(x,D.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:D.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(p){var x=this,o=x._html;x._html=p,"html"===x.getHtmlType()&&"Handlebars"in C&&(x.$10f=Handlebars.compile(p)),x.$13f(),x.fp("html",o,p)},setContext:function(p){var J=this,O=J._context;J._context=p,J.fp("context",O,p),J.$13f()},setScalable:function(_){var i=this,c=i._scalable;i._scalable=_,i.fp("scalable",c,_),i.$13f()},getHtmlType:function(){var v=this._html;return v?"string"==typeof v?"html":v.getView?"ht":"dom":null},$13f:function(){var A=this,e=A._html,v=A.$10f;if(e){var u=j(),z=!1,K=A.getHtmlType();if(Q(u,O,r),Q(u,J,Z),Q(u,R,G),"html"===K?(u.innerHTML=v?v(A.getContext()||{}):e,z=!0):"ht"===K?(t(u,e.getView()),z=!0):"dom"===K&&(t(u,e),z=!0),z){var s=2*A._padding;t(l(),u),A.$5f=u.scrollWidth,A.$6f=u.scrollHeight,A._width=A.$5f+s,A._height=A.$6f+s,A._originWidth=A._width,A._originHeight=A._height,E(l(),u)}}},getUIClass:function(){return D.HtmlNodeUI}})}(this,Object);